{"ast":null,"code":"import{useEffect,useState}from\"react\";import Popup from\"../components/Popup\";import{calculateTotalMoneyForDetailedSales,countRepeatedSales}from\"../helpers\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const DetailedSales=()=>{const[soldProducts,setSoldProducts]=useState([]);const[productToDelete,setProductToDelete]=useState();const[productQtyToDelete,setProductQtyToDelete]=useState();const[productDiscountToDelete,setProductDiscountToDelete]=useState();const[popupVisible,setPopupVisible]=useState(false);const[totalMoney,setTotalMoney]=useState(0);// Set Initial Sold Products And Total Money\nconst sales=localStorage.getItem(\"sales\");useEffect(()=>{if(sales){let salesData=JSON.parse(sales);setSoldProducts(salesData);setTotalMoney(calculateTotalMoneyForDetailedSales(salesData));}},[]);const handleDeletion=(productBarcode,qty,discount)=>{setPopupVisible(true);setProductToDelete(productBarcode);setProductQtyToDelete(qty);setProductDiscountToDelete(discount);};const deleteProduct=()=>{const updatedSales=[];// Update Sold Products\nlet sucssDelte=false;soldProducts.map(product=>{if(product.barcode!==productToDelete&&product.qty!==productQtyToDelete&&product.discount!==productDiscountToDelete){updatedSales.push(product);}else{if(!sucssDelte){sucssDelte=true;}else{updatedSales.push(product);sucssDelte=true;}}});// Update Local Sales State\nsetSoldProducts(updatedSales);// Recalculate Total Money\nsetTotalMoney(calculateTotalMoneyForDetailedSales(updatedSales));// Update LocaleStorage\nlocalStorage.setItem(\"sales\",JSON.stringify(updatedSales));// Close Modal and Reset State\nsetPopupVisible(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 mb-2 bg-gray-100 rounded-md mt-11\",children:[soldProducts&&soldProducts.map(product=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between p-3 mb-2 bg-gray-200 rounded-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0627\\u0644\\u0625\\u0633\\u0645: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:product.name})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0627\\u0644\\u0643\\u0648\\u062F: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:product.barcode})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0627\\u0644\\u0643\\u0645\\u064A\\u0629 \\u0627\\u0644\\u0645\\u0628\\u0627\\u0639\\u0629: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:product.qty})]}),product.discount===\"نعم\"?/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0633\\u0639\\u0631 \\u0627\\u0644\\u0642\\u0637\\u0639\\u0629 \\u0628\\u0639\\u062F \\u0627\\u0644\\u062E\\u0635\\u0645: \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold\",children:[product.price,\"$\"]})]}):/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0633\\u0639\\u0631 \\u0627\\u0644\\u0642\\u0637\\u0639\\u0629: \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold\",children:[product.price,\"$\"]})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0647\\u0644 \\u064A\\u0648\\u062C\\u062F \\u062E\\u0635\\u0645\\u061F \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:product.discount})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(\"button\",{className:\"p-1 rounded-full bg-red-500 transition duration-200 hover:bg-red-800 hover:text-white\",onClick:()=>handleDeletion(product.barcode),children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20px\",fill:\"white\",\"enable-background\":\"new 0 0 55 55\",viewBox:\"0 0 55 55\",id:\"trash\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M43.19,7.97h-8.42V5.51c0-1.66-1.35-3.01-3.01-3.01h-8.52c-1.66,0-3.01,1.35-3.01,3.01v2.46h-8.42\\r c-2.32,0-4.22,1.89-4.22,4.22v4.14c0,0.55,0.45,1,1,1h2.09v30.96c0,2.33,1.89,4.22,4.21,4.22H40.1c2.33,0,4.22-1.89,4.22-4.22\\r V17.32h2.09c0.55,0,1-0.45,1-1v-4.14C47.41,9.86,45.52,7.97,43.19,7.97z M22.23,5.51c0-0.56,0.45-1.01,1.01-1.01h8.52\\r c0.56,0,1.01,0.45,1.01,1.01v2.46H22.23V5.51z M42.32,48.28c0,1.23-0.99,2.22-2.22,2.22H14.89c-1.22,0-2.21-0.99-2.21-2.22V17.32\\r h29.64V48.28z M45.41,15.32H9.59v-3.14c0-1.22,0.99-2.22,2.22-2.22h31.39c1.22,0,2.22,0.99,2.22,2.22V15.32z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M30.77 46.5c.55 0 1-.45 1-1V22.32c0-.55-.45-1-1-1s-1 .45-1 1V45.5C29.77 46.05 30.22 46.5 30.77 46.5zM24.23 46.5c.55 0 1-.45 1-1V22.32c0-.55-.45-1-1-1s-1 .45-1 1V45.5C23.23 46.05 23.67 46.5 24.23 46.5zM37.32 46.5c.55 0 1-.45 1-1V22.32c0-.55-.45-1-1-1s-1 .45-1 1V45.5C36.32 46.05 36.77 46.5 37.32 46.5zM17.68 46.5c.55 0 1-.45 1-1V22.32c0-.55-.45-1-1-1s-1 .45-1 1V45.5C16.68 46.05 17.13 46.5 17.68 46.5z\"})]})})})]})),popupVisible&&/*#__PURE__*/_jsx(Popup,{text:\"\\u0647\\u0644 \\u0623\\u0646\\u062A \\u0645\\u062A\\u0623\\u0643\\u062F \\u0645\\u0646 \\u0623\\u0646\\u0643 \\u062A\\u0631\\u064A\\u062F \\u062D\\u0630\\u0641 \\u0627\\u0644\\u0645\\u0646\\u062A\\u062C \\u0627\\u0644\\u0630\\u064A \\u0628\\u0627\\u0631\\u0643\\u0648\\u062F\\u0647:  (\".concat(productToDelete,\") ?\"),options:true,confirmFun:deleteProduct,closePopupFun:()=>setPopupVisible(false)}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 bg-yellow-400 rounded-md\",children:[\"\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A \\u0645\\u0628\\u0644\\u063A \\u0627\\u0644\\u0645\\u0628\\u064A\\u0639\\u0627\\u062A:\",/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold ms-1\",children:[totalMoney.toLocaleString(),\"$\"]})]})]});};export default DetailedSales;","map":{"version":3,"names":["useEffect","useState","Popup","calculateTotalMoneyForDetailedSales","countRepeatedSales","jsx","_jsx","jsxs","_jsxs","DetailedSales","soldProducts","setSoldProducts","productToDelete","setProductToDelete","productQtyToDelete","setProductQtyToDelete","productDiscountToDelete","setProductDiscountToDelete","popupVisible","setPopupVisible","totalMoney","setTotalMoney","sales","localStorage","getItem","salesData","JSON","parse","handleDeletion","productBarcode","qty","discount","deleteProduct","updatedSales","sucssDelte","map","product","barcode","push","setItem","stringify","className","children","name","price","onClick","xmlns","width","fill","viewBox","id","d","text","concat","options","confirmFun","closePopupFun","toLocaleString"],"sources":["D:/web/Free_Projects/mini-toysBox-truck-cashier-sys/src/pages/DetailedSales.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport Popup from \"../components/Popup\";\r\nimport { calculateTotalMoneyForDetailedSales, countRepeatedSales } from \"../helpers\";\r\n\r\nconst DetailedSales = () => {\r\n    const [soldProducts, setSoldProducts] = useState([]);\r\n    const [productToDelete, setProductToDelete] = useState();\r\n    const [productQtyToDelete, setProductQtyToDelete] = useState();\r\n    const [productDiscountToDelete, setProductDiscountToDelete] = useState();\r\n    const [popupVisible, setPopupVisible] = useState(false);\r\n    const [totalMoney, setTotalMoney] = useState(0);\r\n\r\n    // Set Initial Sold Products And Total Money\r\n    const sales = localStorage.getItem(\"sales\");\r\n    useEffect(() => {\r\n        if (sales) {\r\n            let salesData = JSON.parse(sales);\r\n            setSoldProducts(salesData);\r\n            setTotalMoney(calculateTotalMoneyForDetailedSales(salesData));\r\n        }\r\n    },[]);\r\n\r\n    const handleDeletion = (productBarcode, qty, discount) => {\r\n        setPopupVisible(true);\r\n        setProductToDelete(productBarcode);\r\n        setProductQtyToDelete(qty);\r\n        setProductDiscountToDelete(discount);\r\n    };\r\n    const deleteProduct = () => {\r\n        const updatedSales = []\r\n\r\n        // Update Sold Products\r\n        let sucssDelte = false;\r\n        soldProducts.map((product) => {\r\n            if((product.barcode !== productToDelete) && (product.qty !== productQtyToDelete)  && (product.discount !== productDiscountToDelete)) {\r\n                updatedSales.push(product);\r\n            } else {\r\n                if (!sucssDelte) {\r\n                    sucssDelte = true;\r\n                } else {\r\n                    updatedSales.push(product);\r\n                    sucssDelte = true;\r\n                }\r\n            }\r\n        });\r\n        // Update Local Sales State\r\n        setSoldProducts(updatedSales);\r\n        // Recalculate Total Money\r\n        setTotalMoney(calculateTotalMoneyForDetailedSales(updatedSales));\r\n        // Update LocaleStorage\r\n        localStorage.setItem(\"sales\", JSON.stringify(updatedSales));\r\n        // Close Modal and Reset State\r\n        setPopupVisible(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-3 mb-2 bg-gray-100 rounded-md mt-11\">\r\n            {/* Start Sales */}\r\n            {soldProducts && soldProducts.map(product => (\r\n                <div className=\"flex justify-between p-3 mb-2 bg-gray-200 rounded-md\">\r\n                    <div className=\"\">\r\n                        <p>الإسم: <span className=\"font-bold\">{product.name}</span></p>\r\n                        <p>الكود: <span className=\"font-bold\">{product.barcode}</span></p>\r\n                        <p>الكمية المباعة: <span className=\"font-bold\">{product.qty}</span></p>\r\n                        {product.discount === \"نعم\" ? (\r\n                            <p>سعر القطعة بعد الخصم: <span className=\"font-bold\">{product.price}$</span></p>\r\n                        ) : (\r\n                            <p>سعر القطعة: <span className=\"font-bold\">{product.price}$</span></p>\r\n                        )}\r\n                        <p>هل يوجد خصم؟ <span className=\"font-bold\">{product.discount}</span></p>\r\n                    </div>\r\n                    <div className=\"\">\r\n                        {/* <button\r\n                            className=\"block mb-3 transition duration-200 hover:bg-blue-300 hover:text-white\"\r\n                            >\r\n                                Edit\r\n                        </button> */}\r\n                        <button\r\n                            className=\"p-1 rounded-full bg-red-500 transition duration-200 hover:bg-red-800 hover:text-white\"\r\n                            onClick={() => handleDeletion(product.barcode)}\r\n                        >\r\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" fill=\"white\" enable-background=\"new 0 0 55 55\" viewBox=\"0 0 55 55\" id=\"trash\"><path d=\"M43.19,7.97h-8.42V5.51c0-1.66-1.35-3.01-3.01-3.01h-8.52c-1.66,0-3.01,1.35-3.01,3.01v2.46h-8.42\r\n                                c-2.32,0-4.22,1.89-4.22,4.22v4.14c0,0.55,0.45,1,1,1h2.09v30.96c0,2.33,1.89,4.22,4.21,4.22H40.1c2.33,0,4.22-1.89,4.22-4.22\r\n                                V17.32h2.09c0.55,0,1-0.45,1-1v-4.14C47.41,9.86,45.52,7.97,43.19,7.97z M22.23,5.51c0-0.56,0.45-1.01,1.01-1.01h8.52\r\n                                c0.56,0,1.01,0.45,1.01,1.01v2.46H22.23V5.51z M42.32,48.28c0,1.23-0.99,2.22-2.22,2.22H14.89c-1.22,0-2.21-0.99-2.21-2.22V17.32\r\n                                h29.64V48.28z M45.41,15.32H9.59v-3.14c0-1.22,0.99-2.22,2.22-2.22h31.39c1.22,0,2.22,0.99,2.22,2.22V15.32z\"></path><path d=\"M30.77 46.5c.55 0 1-.45 1-1V22.32c0-.55-.45-1-1-1s-1 .45-1 1V45.5C29.77 46.05 30.22 46.5 30.77 46.5zM24.23 46.5c.55 0 1-.45 1-1V22.32c0-.55-.45-1-1-1s-1 .45-1 1V45.5C23.23 46.05 23.67 46.5 24.23 46.5zM37.32 46.5c.55 0 1-.45 1-1V22.32c0-.55-.45-1-1-1s-1 .45-1 1V45.5C36.32 46.05 36.77 46.5 37.32 46.5zM17.68 46.5c.55 0 1-.45 1-1V22.32c0-.55-.45-1-1-1s-1 .45-1 1V45.5C16.68 46.05 17.13 46.5 17.68 46.5z\"></path>\r\n                            </svg>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            ))}\r\n            {/* End Sales */}\r\n\r\n            {/* Start Popup Container */}\r\n            {popupVisible &&\r\n                <Popup\r\n                    text={`هل أنت متأكد من أنك تريد حذف المنتج الذي باركوده:  (${productToDelete}) ?`}\r\n                    options={true}\r\n                    confirmFun={deleteProduct}\r\n                    closePopupFun={() => setPopupVisible(false)}\r\n                />}\r\n            {/* End Popup Container */}\r\n\r\n            {/* Start Total Money */}\r\n            {/* End Total Money */}\r\n            <div className=\"p-2 bg-yellow-400 rounded-md\"\r\n                >\r\n                    إجمالي مبلغ المبيعات:  \r\n                <span className=\"font-bold ms-1\">\r\n                    {totalMoney.toLocaleString()}$\r\n                </span>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default DetailedSales;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}