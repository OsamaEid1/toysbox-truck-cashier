{"ast":null,"code":"import{useEffect,useState}from\"react\";import{addNewSell}from\"../helpers\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const BuyingProcess=_ref=>{let{product}=_ref;console.log(\"object\",product);const[qtyWillBuy,setQtyWillBuy]=useState(1);const[isWithDiscount,setIsWithDiscount]=useState(false);const[totalPrice,setTotalPrice]=useState(0);const DISCOUNT_PERCENTAGE=0.10;const handleSubmit=async e=>{e.preventDefault();if(+product.stock>=qtyWillBuy){// Calculate Price That Will Pay\nlet priceWillPay=isWithDiscount?product.price*(1-DISCOUNT_PERCENTAGE):product.price;//  Add New Sell To DB\nconst newSell={barcode:product.barcode,name:product.name,price:priceWillPay,qty:qtyWillBuy,discount:isWithDiscount?\"نعم\":\"لا\"};if(await addNewSell(newSell)){// Notify user about successful sale\nalert('Successful Sale!');}else alert(\"Field Sale!\");//     // Update Product Stock\n//     const newStock = product.stock - qtyWillBuy;\n//     console.log(newStock);\n//     if(await updateProductStockInDB(product.barcode, newStock)) {\n//         // Notify user about successful sale\n//         alert('Updated Stock Successfully!');\n//     } else alert(\"Field To Update Stock!\");\n}else alert(\"enter valid quantity!\");};const[isDiscountDisabled,setIsDiscountDisabled]=useState(true);useEffect(()=>{if(product){let newTotalPrice=isWithDiscount?parseFloat(product.price).toFixed()*qtyWillBuy*(1-DISCOUNT_PERCENTAGE):qtyWillBuy*Math.ceil(parseFloat(product.price));setTotalPrice(newTotalPrice);const totalPriceWithoutDiscount=qtyWillBuy*Math.ceil(parseFloat(product.price))<300;if(!totalPriceWithoutDiscount){setIsDiscountDisabled(false);}else{setIsDiscountDisabled(true);}}},[qtyWillBuy,isWithDiscount,product]);return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"bg-green-200 rounded-t-lg pt-5\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"ms-12 select-none\",children:[\"\\u0627\\u0644\\u0643\\u0645\\u064A\\u0629:\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",required:true,min:1,max:product===null||product===void 0?void 0:product.stock,value:qtyWillBuy,onChange:e=>setQtyWillBuy(e.target.value),className:\"ms-3 w-12 text-center rounded border border-main-color\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"me-12 select-none float-end \".concat(isDiscountDisabled?'text-gray-500':''),children:[\"\\u062E\\u0635\\u0645 \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold\",children:[DISCOUNT_PERCENTAGE*100,\"%\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isWithDiscount,disabled:isDiscountDisabled,onChange:()=>setIsWithDiscount(!isWithDiscount),className:\"ms-2\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-center\",children:[\"\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A \\u0627\\u0644\\u0645\\u0628\\u0644\\u063A: \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold\",children:[totalPrice.toFixed(),\"$\"]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"block w-full bg-green-500 font-bold p-1 my-4 rounded-lg\",children:\"\\u0625\\u062A\\u0645\\u0627\\u0645 \\u0627\\u0644\\u0634\\u0631\\u0627\\u0621\"})]});};export default BuyingProcess;","map":{"version":3,"names":["useEffect","useState","addNewSell","jsx","_jsx","jsxs","_jsxs","BuyingProcess","_ref","product","console","log","qtyWillBuy","setQtyWillBuy","isWithDiscount","setIsWithDiscount","totalPrice","setTotalPrice","DISCOUNT_PERCENTAGE","handleSubmit","e","preventDefault","stock","priceWillPay","price","newSell","barcode","name","qty","discount","alert","isDiscountDisabled","setIsDiscountDisabled","newTotalPrice","parseFloat","toFixed","Math","ceil","totalPriceWithoutDiscount","onSubmit","className","children","type","required","min","max","value","onChange","target","concat","checked","disabled"],"sources":["D:/web/Free_Projects/mini-toysBox-truck-cashier-sys/src/components/BuyingProcess.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { addNewSell } from \"../helpers\";\r\n\r\nconst BuyingProcess = ({ product }) => {\r\n    console.log(\"object\", product);\r\n    const [qtyWillBuy, setQtyWillBuy] = useState(1);\r\n    const [isWithDiscount, setIsWithDiscount] = useState(false);\r\n    const [totalPrice, setTotalPrice] = useState(0);\r\n\r\n    const DISCOUNT_PERCENTAGE = 0.10;\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        \r\n        if (+product.stock >= qtyWillBuy) {\r\n            // Calculate Price That Will Pay\r\n            let priceWillPay = isWithDiscount\r\n                    ? product.price * (1 - DISCOUNT_PERCENTAGE)\r\n                    : product.price;\r\n\r\n            //  Add New Sell To DB\r\n            const newSell = {\r\n                barcode: product.barcode,\r\n                name: product.name,\r\n                price: priceWillPay,\r\n                qty: qtyWillBuy,\r\n                discount: isWithDiscount ? \"نعم\" : \"لا\"\r\n            };\r\n            if(await addNewSell(newSell)) {\r\n                // Notify user about successful sale\r\n                alert('Successful Sale!');\r\n            } else alert(\"Field Sale!\");\r\n\r\n        //     // Update Product Stock\r\n        //     const newStock = product.stock - qtyWillBuy;\r\n        //     console.log(newStock);\r\n        //     if(await updateProductStockInDB(product.barcode, newStock)) {\r\n        //         // Notify user about successful sale\r\n        //         alert('Updated Stock Successfully!');\r\n        //     } else alert(\"Field To Update Stock!\");\r\n\r\n        } else alert(\"enter valid quantity!\")\r\n    };\r\n\r\n    const [isDiscountDisabled, setIsDiscountDisabled] = useState(true);\r\n    useEffect(() => {\r\n        if (product) {\r\n            let newTotalPrice = isWithDiscount ?\r\n                    ((parseFloat(product.price).toFixed() * qtyWillBuy) * (1 - DISCOUNT_PERCENTAGE)) :\r\n                    qtyWillBuy * Math.ceil(parseFloat(product.price));\r\n            setTotalPrice(newTotalPrice);\r\n\r\n            const totalPriceWithoutDiscount = qtyWillBuy * Math.ceil(parseFloat(product.price)) < 300;\r\n            if (!totalPriceWithoutDiscount) {\r\n                setIsDiscountDisabled(false)\r\n            } else {\r\n                setIsDiscountDisabled(true)\r\n            }\r\n        }\r\n    },[qtyWillBuy, isWithDiscount, product]);\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} className=\"bg-green-200 rounded-t-lg pt-5\">\r\n            <label className=\"ms-12 select-none\">\r\n                الكمية:\r\n                <input \r\n                    type=\"number\" \r\n                    required\r\n                    min={1}\r\n                    max={product?.stock}\r\n                    value={qtyWillBuy} \r\n                    onChange={(e) => setQtyWillBuy(e.target.value)}\r\n                    className=\"ms-3 w-12 text-center rounded border border-main-color\"\r\n                />\r\n            </label>\r\n            <label className={`me-12 select-none float-end ${isDiscountDisabled ? 'text-gray-500' : ''}`}>\r\n                خصم <span className=\"font-bold\">{DISCOUNT_PERCENTAGE * 100}%</span>\r\n                <input \r\n                    type=\"checkbox\" \r\n                    checked={isWithDiscount}\r\n                    disabled= {isDiscountDisabled}\r\n                    onChange={() => setIsWithDiscount(!isWithDiscount)}\r\n                    className=\"ms-2\"\r\n                />\r\n            </label>\r\n            <p className=\"text-center\">إجمالي المبلغ: <span className=\"font-bold\">{totalPrice.toFixed()}$</span></p>\r\n            <button type=\"submit\" className=\"block w-full bg-green-500 font-bold p-1 my-4 rounded-lg\">إتمام الشراء</button>\r\n        </form>\r\n    );\r\n}\r\n\r\nexport default BuyingProcess;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}